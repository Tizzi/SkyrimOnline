//--------------------------------------------------------------------------------
/// @author Maxime GRIOT
//--------------------------------------------------------------------------------

#pragma once

namespace SkyrimOnline
{
	namespace Overlay
	{
		//--------------------------------------------------------------------------------
		/// @brief A chat interface for the client
		//--------------------------------------------------------------------------------
		class Chat
		{
		public:

			//--------------------------------------------------------------------------------
			/// @brief Hides the chat
			//--------------------------------------------------------------------------------
			void	Hide();

			//--------------------------------------------------------------------------------
			/// @brief Shows the chat
			//--------------------------------------------------------------------------------
			void	Show();

			//--------------------------------------------------------------------------------
			/// @brief Set the console's visibility
			/// @param n self explanatory
			//--------------------------------------------------------------------------------
			void	SetVisible(bool isVisible);

			//--------------------------------------------------------------------------------
			/// @brief Is the console visible or not
			/// @return visibility
			//--------------------------------------------------------------------------------
			bool	IsVisible();

			//--------------------------------------------------------------------------------
			/// @brief Add something to the console's log
			/// @param str The string to add
			//--------------------------------------------------------------------------------
			void	Log(const MyGUI::UString& str, const MyGUI::UString& color = "");

			//--------------------------------------------------------------------------------
			/// @brief Updates the chat
			//--------------------------------------------------------------------------------
			void Update(double);

			bool Setup(){return true;}

			void Destroy(){}

			//--------------------------------------------------------------------------------
			/// @brief Handles an edit box accept event.
			/// @param _widget The widget firing the event.
			//--------------------------------------------------------------------------------
			void Handle_Click(MyGUI::WidgetPtr _widget);

			//--------------------------------------------------------------------------------
			/// @brief Constructor, do not call
			//--------------------------------------------------------------------------------
			Chat(MyGUI::Gui*);

			//--------------------------------------------------------------------------------
			/// @brief Destructor, do not call
			//--------------------------------------------------------------------------------
			~Chat();

		private:

			//--------------------------------------------------------------------------------
			/// @brief Add something to the console's log
			/// @param str The string to add
			//--------------------------------------------------------------------------------
			void	_Log(const MyGUI::UString& str, const MyGUI::UString& color);

			//--------------------------------------------------------------------------------
			/// @brief The console's list box
			//--------------------------------------------------------------------------------
			MyGUI::ListPtr		     mList;
			std::list<std::pair<MyGUI::UString,MyGUI::UString>> mMessages;
			boost::mutex			  mMessagesMutex;
			//--------------------------------------------------------------------------------
			/// @brief The console's edit box
			//--------------------------------------------------------------------------------
			MyGUI::EditPtr			mEdit;

			MyGUI::Gui*				mUI;
		};
	}
}